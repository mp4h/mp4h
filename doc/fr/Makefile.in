##
##  Makefile -- MP4H Documentation
##

@SET_MAKE@
SHELL = /bin/sh

top_srcdir      = @top_srcdir@
VPATH           = @srcdir@
PROGDIR         = $(top_srcdir)/src
PROGRAM         = $(PROGDIR)/mp4h
INCDIR          = ..
DEPS            = ../list-tags
TIDYOPT         = -latin1

RM              = rm -f

# ------------------------------------------------
#   THE DEFAULT TARGETS
# ------------------------------------------------

all: mp4h.html mp4h.1

# ------------------------------------------------
#   DOCUMENTATION
# ------------------------------------------------

#   Do not rebuild HTML documentation
mp4h.html: mp4h.mp4h $(INCDIR)/html.out
	LC_CTYPE=fr_FR; export LC_CTYPE; \
	PATH=$(PROGDIR):$(PATH) mp4h -D format=html -I $(INCDIR) mp4h.mp4h > $@
	tidy $(TIDYOPT) -m $@

mp4h.pod: mp4h.mp4h $(INCDIR)/pod.out $(PROGRAM) $(DEPS)
	PATH=$(PROGDIR):$(PATH) mp4h -D format=pod -I $(INCDIR) mp4h.mp4h \
	| sed -e 's/_LT_/</g' -e 's/_GT_/>/g' > $@

mp4h.1: mp4h.pod
	pod2man --section=1 \
            --center="HTML Tools" \
            --release="HTML Tools" \
        mp4h.pod > $@

mp4h.texinfo: mp4h.mp4h $(INCDIR)/texinfo.out $(PROGRAM) $(DEPS)
	PATH=$(PROGDIR):$(PATH) mp4h -D format=texinfo -I $(INCDIR) mp4h.mp4h \
	| sed -e 's/_LT_/</g' -e 's/_GT_/>/g' > $@

mp4h.info: mp4h.texinfo
	makeinfo mp4h.texinfo

# ------------------------------------------------
#   PROGRAM
# ------------------------------------------------

$(PROGRAM):
	cd $(PROGDIR) && $(MAKE)

# ------------------------------------------------
#   CLEANUP
# ------------------------------------------------

clean:
	$(RM) *.pod *.1 *.info *.texinfo

realclean: clean
	$(RM) *.html

distclean: clean
	$(RM) Makefile

##EOF##
