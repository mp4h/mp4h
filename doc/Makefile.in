##
##  Makefile -- MP4H Documentation
##

@SET_MAKE@
SHELL = /bin/sh

top_srcdir      = @top_srcdir@
srcdir          = @srcdir@
tmpdir          = @tmpdir@
VPATH           = @srcdir@

RM              = rm -f

SHTOOL          = $(top_srcdir)/shtool
VERSION_TOOL    = $(SHTOOL) version

# ------------------------------------------------
#   THE DEFAULT TARGETS
# ------------------------------------------------

all: mp4h.html mp4h.1

# ------------------------------------------------
#   DOCUMENTATION
# ------------------------------------------------

mp4h.html: mp4h.mp4h html.out ../src/mp4h
	V=`$(VERSION_TOOL) -l c -d long ../src/version.c`;\
	sed -e "s|@LONG_VERSION\@|$$V|g" < mp4h.mp4h \
	| ../src/mp4h -D format=html > $@

mp4h.pod: mp4h.mp4h pod.out ../src/mp4h
	V=`$(VERSION_TOOL) -l c -d long ../src/version.c`;\
	sed -e "s|@LONG_VERSION\@|$$V|g" < mp4h.mp4h \
	| ../src/mp4h -D format=pod \
	| sed -e 's/_LT_/</g' -e 's/_GT_/>/g' > $@

mp4h.1: mp4h.pod
	pod2man --section=1 \
            --center="HTML Tools" \
            --release="HTML Tools" \
        mp4h.pod > $@


# ------------------------------------------------
#   PROGRAM
# ------------------------------------------------

../src/mp4h:
	cd .. && $(MAKE)

# ------------------------------------------------
#   CLEANUP
# ------------------------------------------------

clean:
	$(RM) *.html *.pod *.1

distclean: clean
	$(RM) Makefile

##EOF##
